<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:CircularMidiGenerator.ViewModels"
        xmlns:controls="using:CircularMidiGenerator.Controls"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d" d:DesignWidth="1000" d:DesignHeight="700"
        x:Class="CircularMidiGenerator.Views.MainWindow"
        x:DataType="vm:MainViewModel"
        Title="ðŸŽµ Circular MIDI Generator"
        Width="1000" Height="700"
        Background="#1A0B2E"
        MinWidth="800" MinHeight="600">

    <Design.DataContext>
        <vm:MainViewModel />
    </Design.DataContext>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        
        <!-- Menu Bar -->
        <Menu Grid.Row="0" Background="#2A1B3D" Foreground="White">
            <MenuItem Header="_File">
                <MenuItem Header="_New Project" Command="{Binding NewProjectCommand}"/>
                <MenuItem Header="_Open..." Command="{Binding LoadConfigurationCommand}"/>
                <MenuItem Header="_Save" Command="{Binding SaveConfigurationCommand}"/>
                <MenuItem Header="E_xit"/>
            </MenuItem>
            <MenuItem Header="_Edit">
                <MenuItem Header="Select _All Markers" Command="{Binding SelectAllMarkersCommand}"/>
                <MenuItem Header="_Clear All Markers" Command="{Binding ClearAllMarkersCommand}"/>
            </MenuItem>
            <MenuItem Header="_Playback">
                <MenuItem Header="_Play" Command="{Binding PlayCommand}"/>
                <MenuItem Header="_Stop" Command="{Binding StopCommand}"/>
            </MenuItem>
            <MenuItem Header="_View">
                <MenuItem Header="Show _Grid" Command="{Binding ToggleQuantizationCommand}"/>
            </MenuItem>
        </Menu>
        
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="300"/>
            </Grid.ColumnDefinitions>
        
            <!-- Main Content Area -->
            <Grid Grid.Column="0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Top Control Panel -->
                <Border Grid.Row="0" Background="#2A1B3D" CornerRadius="15" BorderBrush="#FF6B9D" BorderThickness="2" Padding="15" Margin="10">
                    <StackPanel Orientation="Horizontal" Spacing="20" HorizontalAlignment="Center">
                        <!-- Playback Controls -->
                        <Button Content="ðŸŽµ Play" 
                                Command="{Binding PlayCommand}"
                                IsEnabled="{Binding !IsPlaying}"
                                Background="#06FFA5"
                                Foreground="White"
                                Padding="20,10"
                                CornerRadius="25"/>
                        
                        <Button Content="â¹ Stop" 
                                Command="{Binding StopCommand}"
                                IsEnabled="{Binding IsPlaying}"
                                Background="#FF6B9D"
                                Foreground="White"
                                Padding="20,10"
                                CornerRadius="25"/>

                        <!-- BPM Control -->
                        <StackPanel Orientation="Horizontal" Spacing="10">
                            <TextBlock Text="BPM:" VerticalAlignment="Center" Foreground="White" FontWeight="Bold"/>
                            <NumericUpDown Value="{Binding BPM}" 
                                           Minimum="60" 
                                           Maximum="200" 
                                           Width="80"
                                           Background="#44318D"
                                           Foreground="White"/>
                        </StackPanel>

                        <!-- Quantization -->
                        <CheckBox Content="Quantize" 
                                  IsChecked="{Binding IsQuantizationEnabled}"
                                  Foreground="White"/>

                        <!-- File Operations -->
                        <Button Content="ðŸ’¾ Save" 
                                Command="{Binding SaveConfigurationCommand}"
                                Background="#4ECDC4"
                                Foreground="White"
                                Padding="15,8"
                                CornerRadius="20"/>
                        
                        <Button Content="ðŸ“ Load" 
                                Command="{Binding LoadConfigurationCommand}"
                                Background="#FFD23F"
                                Foreground="White"
                                Padding="15,8"
                                CornerRadius="20"/>
                    </StackPanel>
                </Border>

                <!-- Main Canvas Area -->
                <Border Grid.Row="1" Margin="10" CornerRadius="25" BorderBrush="#FF6B9D" BorderThickness="3" Background="#0F0A1A">
                    <Grid>
                        <!-- Circular Canvas Control -->
                        <controls:CircularCanvas x:Name="CircularCanvas"
                                               HorizontalAlignment="Stretch"
                                               VerticalAlignment="Stretch"
                                               Margin="30"/>
                        
                        <!-- Instructions -->
                        <Border HorizontalAlignment="Center" VerticalAlignment="Bottom" Margin="0,0,0,30"
                                Background="#2A1B3D" CornerRadius="15" Padding="20,10" BorderBrush="#FF6B9D" BorderThickness="1">
                            <TextBlock Text="âœ¨ Click to place markers â€¢ Drag to move â€¢ Drag outside to remove âœ¨" 
                                       Foreground="White"
                                       TextAlignment="Center"/>
                        </Border>
                    </Grid>
                </Border>

                <!-- Status Bar -->
                <Border Grid.Row="2" Background="#2A1B3D" BorderBrush="#FF6B9D" BorderThickness="0,2,0,0" Padding="20,12" Margin="10">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        
                        <TextBlock Grid.Column="0" 
                                   Text="{Binding StatusMessage}" 
                                   Foreground="White" 
                                   VerticalAlignment="Center"/>
                        
                        <TextBlock Grid.Column="1" 
                                   Text="{Binding PlayheadAngle, StringFormat='ðŸŽ¯ {0:F1}Â°'}" 
                                   Foreground="#FFD23F" 
                                   VerticalAlignment="Center"/>
                    </Grid>
                </Border>
            </Grid>

            <!-- Lane Management Panel -->
            <Border Grid.Column="1" Background="#2A1B3D" BorderBrush="#FF8E53" BorderThickness="3,0,0,0" Margin="0,10,10,10">
                <controls:LanePanel DataContext="{Binding}"/>
            </Border>
        </Grid>
    </Grid>
</Window>